/*! For license information please see news.js.LICENSE.txt */
!function(){var t={6381:function(t){t.exports=function(){"use strict";function t(t,n){var e,r=Object.keys(t);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(t),n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.push.apply(r,e)),r}function n(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?t(Object(r),!0).forEach((function(t){i(n,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))}))}return n}function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function o(t,n,e){n&&r(t.prototype,n),e&&r(t,e),Object.defineProperty(t,"prototype",{writable:!1})}function i(t,n,e){(n=f(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&s(t,n)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,n){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t})(t,n)}function c(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=u(t);return function(t,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(n=t))throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(this,n?(e=u(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments))}}function f(t){return t=function(t,n){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return String(t);if("object"!=typeof(e=e.call(t,"string")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(t),"symbol"==typeof t?t:String(t)}function l(t){return t=y.formatInTaipeiTime(t).match(/\d+\/\d+\/(\d+) (\d{2}):\d{2}:\d{2}/),[parseInt(t[1],10),parseInt(t[2],10)]}function p(){document.querySelectorAll("[data-number]").forEach((function(t){var n=(e=y.getDataAttributes(t)).number,e=function(t,n){if(null==t)return{};var e,r=function(t,n){if(null==t)return{};for(var e,r={},o=Object.keys(t),i=0;i<o.length;i++)e=o[i],0<=n.indexOf(e)||(r[e]=t[e]);return r}(t,n);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(t),i=0;i<o.length;i++)e=o[i],0<=n.indexOf(e)||Object.prototype.propertyIsEnumerable.call(t,e)&&(r[e]=t[e]);return r}(e,D);new x(t,n,e)}))}var h=36e5,y={getDataAttributes:function(t){var e;return t?(e=n({},t.dataset),Object.keys(e).forEach((function(t){e[t]="true"===(t=e[t])||"false"!==t&&(t===Number(t).toString()?Number(t):""===t||"null"===t?null:t)})),e):{}},timeOffset:function(t,n){return new Date(t.getTime()+n)},now:function(){return new Date},formatInTaipeiTime:function(t){return new Date(t).toLocaleString("zh-TW",{timeZone:"Asia/Taipei",hourCycle:"h23"})},toType:function(t){return{}.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()},typeCheckConfig:function(t,n){Object.keys(n).forEach((function(e){var r=n[e],o=t[e];if(o=y.toType(o),!new RegExp(r).test(o))throw new Error('Option "'.concat(e,'" provided type "').concat(o,'" ')+'but expected type "'.concat(r,'".'))}))}},v=1728e5,d=function(){function t(){e(this,t),this._data=null,this.observers=[]}return o(t,[{key:"normalizeData",get:function(){return t.dataProvider.normalizeData}},{key:"rows",get:function(){return this.normalizeData.environmental_impact}},{key:"lastRow",get:function(){return this.normalizeData.last_environmental_impact_row}},{key:"data",get:function(){return this._data},set:function(t){this._data!==(this._data=t)&&this.notify()}},{key:"currentRow",get:function(){var n=l(n=y.timeOffset(y.now(),-v));return this.rows[n]||this.lastRow||t.DUMMY_ROW}},{key:"nextRow",get:function(){var n=l(n=y.timeOffset(y.now(),-v+h));return this.rows[n]||this.lastRow||t.DUMMY_ROW}},{key:"next",value:function(){throw"not implement"}},{key:"subscribe",value:function(t){var n=this;if("function"!=typeof t)throw"callback must be a function";(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).once?this.observers.push((function e(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];t.apply(n,o);var a=n.observers.indexOf(e);n.observers.splice(a,1)})):this.observers.push(t),this.data&&this.notify()}},{key:"notify",value:function(){var t=this;this.observers.slice().forEach((function(n){n(t.data)}))}}],[{key:"installProvider",value:function(t){this.dataProvider=t}}]),t}(),m=(i(d,"dataProvider",void 0),i(d,"DUMMY_ROW",new Proxy({},{get:function(){return 0}})),function(){a(n,d);var t=c(n);function n(){return e(this,n),t.apply(this,arguments)}return o(n,[{key:"next",value:function(){var t,n;this.data||(t=(n=this.normalizeData.counts).vm_operating_count,n=n.vm_prebuild_count,this.data=t+n)}}]),n}()),b=function(){a(n,d);var t=c(n);function n(){return e(this,n),t.apply(this,arguments)}return o(n,[{key:"next",value:function(){this.data||(this.data=this.normalizeData.counts.vm_prebuild_count)}}]),n}(),w=function(){a(n,d);var t=c(n);function n(){return e(this,n),t.apply(this,arguments)}return o(n,[{key:"next",value:function(){this.data||(this.data=this.normalizeData.counts.vm_operating_count)}}]),n}(),g=function(){a(n,d);var t=c(n);function n(){return e(this,n),t.apply(this,arguments)}return o(n,[{key:"next",value:function(){this.data=this.normalizeData.stats.co2_saved}}]),n}(),O=function(){a(n,d);var t=c(n);function n(){return e(this,n),t.apply(this,arguments)}return o(n,[{key:"next",value:function(){this.data=this.normalizeData.stats.distance}}]),n}(),_=function(){a(n,d);var t=c(n);function n(){return e(this,n),t.apply(this,arguments)}return o(n,[{key:"next",value:function(){this.data=this.normalizeData.stats.battery_swap_count}}]),n}(),j=function(){a(n,d);var t=c(n);function n(){return e(this,n),t.apply(this,arguments)}return o(n,[{key:"next",value:function(){this.data=Math.round(this.normalizeData.stats.swap_count_per_day*(431494/477851)*2+this.normalizeData.stats.swap_count_per_day*(46357/477851))}}]),n}(),k=function(){a(n,d);var t=c(n);function n(){return e(this,n),t.apply(this,arguments)}return o(n,[{key:"next",value:function(){this.data=this.normalizeData.counts.rack_count}}]),n}(),P=function(){function t(){e(this,t),this.raw={},this.promise=this.load()}return o(t,[{key:"load",value:function(){var t=this;return this.request().then((function(n){t.raw=n,t.normalizeData=t.normalize(n)}))}},{key:"normalize",value:function(t){return n(n({},t),{},{last_environmental_impact_row:t.environmental_impact[t.environmental_impact.length-1],environmental_impact:t.environmental_impact.reduce((function(t,n){var e=n.Time.match(/(\d{2}) (\d{2}):\d{2}:\d{2}/);return t[[parseInt(e[1],10),parseInt(e[2],10)]]=n,t}),{})})}},{key:"request",value:function(){var t=this;return new Promise((function(n){var e=new XMLHttpRequest;e.open("GET",t.constructor.API_ENDPOINT),e.send(),e.onload=function(){n(JSON.parse(e.response))}}))}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new this,d.installProvider(this.instance)),this.instance}}]),t}(),D=(i(P,"API_ENDPOINT","https://cdn.gogoro.com/data/environmental-impact-v3.json"),i(P,"instance",void 0),["number"]),x=function(){function t(r,o){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(e(this,t),this.el=r,this.subjectInstance=this.constructor.subjects[o],!this.subjectInstance)throw"subject ".concat(o," is undefined");this.options=n(n({},t.default),i),y.typeCheckConfig(this.options,t.defaultType),this.subjectInstance.subscribe(this.update.bind(this))}return o(t,[{key:"update",value:function(t){t="function"===y.toType(this.options.transform)?this.options.transform(t):new Function("$val","return ".concat(this.options.transform))(t),this.el.innerHTML=this.options.formatter(t)}}],[{key:"boostrap",value:function(){var t,n=this,e=P.getInstance();return this.init||(this.init=!0,t=function(){for(var t in n.subjects)n.subjects[t].next()},e.promise.then((function(){t(),setInterval(t,1e3),setInterval(e.load.bind(e),h)}))),e.promise}},{key:"getStaticValues",value:function(){var t=this;return P.getInstance().promise.then((function(){var n,e={};for(n in t.subjects){var r=t.subjects[n];r.next(),e[n]=r.data}return e}))}}]),t}();return i(x,"init",!1),i(x,"default",{transform:"$val",formatter:function(t){return String(t).replace(/\B(?=(\d{3})+(?!\d))/g,",")}}),i(x,"defaultType",{transform:"string|function",formatter:"function"}),i(x,"subjects",new Proxy({stationsCount:new m,comingStationsCount:new b,onlineStationsCount:new w,CO2:new g,KM:new O,swapCount:new _,swapCountAvg30Days:new j,rackCount:new k},{get:function(t,n,e){return x.boostrap(),Reflect.get(t,n,e)}})),"loading"!==document.readyState?p():document.addEventListener("DOMContentLoaded",p),x}()}},n={};function e(r){var o=n[r];if(void 0!==o)return o.exports;var i=n[r]={exports:{}};return t[r].call(i.exports,i,i.exports,e),i.exports}!function(){"use strict";e(6381)}()}();