/**
 * Gogoro Word Slide v1.3.1
 * (c) 2019 Yi Feng <yfxie@me.com>
 */
 !function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).WordSlide=n()}(this,function(){"use strict";function i(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===t&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".word-slide {\n  height: 0;\n  overflow: hidden;\n  display: inline-block;\n  vertical-align: top;\n}\n\n.word-slide.sliding .word-slide-track {\n  -webkit-transition: -webkit-transform .2s;\n  transition: -webkit-transform .2s;\n  transition: transform .2s;\n  transition: transform .2s, -webkit-transform .2s;\n}\n\n.word-slide-track {\n  display: -webkit-inline-box;\n  display: inline-flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n          flex-direction: column;\n  height: 100%;\n}"),function(){function n(e){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),this.$wordContainer=$(e),this.setup()}return function(e,n,t){n&&i(e.prototype,n),t&&i(e,t)}(n,[{key:"setup",value:function(){this.$wordSlide=this.$wordContainer.addClass("word-slide-track").wrap('<span class="word-slide"/>').parent(),this.lineHeight=this.$wordContainer.css("line-height"),this.fontSize=this.$wordContainer.css("font-size"),this.height=parseFloat(this.lineHeight)/parseInt(this.fontSize)+"em",this.wordsCount=this.$wordContainer.children().length,this.$wordContainer.children().first().clone().appendTo(this.$wordContainer),this.$wordSlide.css({height:this.height})}},{key:"play",value:function(){var t=this;this.index=0,this.delay=3000;!function e(){var n=parseInt(t.$wordContainer.css("line-height"))*-t.index++;t.$wordContainer.css({transform:"translateY(".concat(n,"px)")}),setTimeout(function(){t.index===t.wordsCount+1?(t.$wordSlide.removeClass("sliding"),t.index=0):t.$wordSlide.addClass("sliding"),t.delay=Math.max(200,1400/(.5*(t.index+1))),setTimeout(e,10)},t.delay)}()}}]),n}()});
 /*!
 * Gogoro Numbers v1.5.3
 * Copyright (c) 2022 Yi Feng <yfxie@me.com>
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).GGRNumber=n()}(this,function(){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function r(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}function o(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function a(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,r)}return e}function u(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?a(e,!0).forEach(function(t){o(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):a(e).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}function e(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&c(t,n)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,n){return(c=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function f(t,n){if(null==t)return{};var e,r,i=function(t,n){if(null==t)return{};var e,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)e=o[r],0<=n.indexOf(e)||(i[e]=t[e]);return i}(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)e=o[r],0<=n.indexOf(e)||Object.prototype.propertyIsEnumerable.call(t,e)&&(i[e]=t[e])}return i}function l(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function h(t){var n=m.formatInTaipeiTime(t).match(/\d+\/\d+\/(\d+) (\d{2}):\d{2}:\d{2}/);return[parseInt(n[1],10),parseInt(n[2],10)]}function p(t,n){var e=m.now(),r=t+(n-t)*((e.getMinutes()*d+e.getSeconds()*v+e.getMilliseconds())/y);return Math.round(r)}var v=1e3,d=6e4,y=36e5,m={getDataAttributes:function(t){if(!t)return{};var n=u({},t.dataset);return Object.keys(n).forEach(function(t){n[t]=function(t){return"true"===t||"false"!==t&&(t===Number(t).toString()?Number(t):""===t||"null"===t?null:t)}(n[t])}),n},timeOffset:function(t,n){return new Date(t.getTime()+n)},now:function(){return new Date},formatInTaipeiTime:function(t){return new Date(t).toLocaleString("zh-TW",{timeZone:"Asia/Taipei",hourCycle:"h23"})},toType:function(t){return{}.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()},typeCheckConfig:function(i,o){Object.keys(o).forEach(function(t){var n=o[t],e=i[t],r=m.toType(e);if(!new RegExp(n).test(r))throw new Error('Option "'.concat(t,'" provided type "').concat(r,'" ')+'but expected type "'.concat(n,'".'))})}},b=2*864e5,w=function(){function t(){i(this,t),this._data=null,this.observers=[]}return n(t,null,[{key:"installProvider",value:function(t){this.dataProvider=t}}]),n(t,[{key:"next",value:function(){throw"not implement"}},{key:"subscribe",value:function(o,t){var a=this;if("function"!=typeof o)throw"callback must be a function";if((1<arguments.length&&void 0!==t?t:{}).once){this.observers.push(function t(){for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];o.apply(a,e);var i=a.observers.indexOf(t);a.observers.splice(i,1)})}else this.observers.push(o);this.data&&this.notify()}},{key:"notify",value:function(){var n=this;this.observers.slice().forEach(function(t){t(n.data)})}},{key:"normalizeData",get:function(){return t.dataProvider.normalizeData}},{key:"rows",get:function(){return this.normalizeData.environmental_impact}},{key:"lastRow",get:function(){return this.normalizeData.last_environmental_impact_row}},{key:"data",get:function(){return this._data},set:function(t){this._data!==(this._data=t)&&this.notify()}},{key:"currentRow",get:function(){var t=m.timeOffset(m.now(),-b),n=h(t);return this.rows[n]||this.lastRow}},{key:"nextRow",get:function(){var t=m.timeOffset(m.now(),-b+y),n=h(t);return this.rows[n]||this.lastRow}}]),t}();o(w,"dataProvider",void 0);var t=function(){function t(){return i(this,t),l(this,s(t).apply(this,arguments))}return e(t,w),n(t,[{key:"next",value:function(){if(!this.data){var t=this.normalizeData.counts,n=t.vm_operating_count,e=t.vm_prebuild_count;this.data=n+e}}}]),t}(),g=function(){function t(){return i(this,t),l(this,s(t).apply(this,arguments))}return e(t,w),n(t,[{key:"next",value:function(){this.data||(this.data=this.normalizeData.counts.vm_prebuild_count)}}]),t}(),O=function(){function t(){return i(this,t),l(this,s(t).apply(this,arguments))}return e(t,w),n(t,[{key:"next",value:function(){this.data||(this.data=this.normalizeData.counts.vm_operating_count)}}]),t}(),_=function(){function t(){return i(this,t),l(this,s(t).apply(this,arguments))}return e(t,w),n(t,[{key:"next",value:function(){this.data=p(this.currentRow.CO2,this.nextRow.CO2)}}]),t}(),j=function(){function t(){return i(this,t),l(this,s(t).apply(this,arguments))}return e(t,w),n(t,[{key:"next",value:function(){this.data=p(this.currentRow.Mileage,this.nextRow.Mileage)}}]),t}(),k=function(){function t(){return i(this,t),l(this,s(t).apply(this,arguments))}return e(t,w),n(t,[{key:"next",value:function(){this.data=p(this.currentRow.BP_Swap,this.nextRow.BP_Swap)}}]),t}(),P=function(){function t(){return i(this,t),l(this,s(t).apply(this,arguments))}return e(t,w),n(t,[{key:"next",value:function(){this.data=p(this.currentRow.BPSwapAvg30Days,this.nextRow.BPSwapAvg30Days)}}]),t}(),x=function(){function t(){return i(this,t),l(this,s(t).apply(this,arguments))}return e(t,w),n(t,[{key:"next",value:function(){this.data=this.normalizeData.counts.rack_count}}]),t}(),D=function(){function t(){i(this,t),this.raw={},this.promise=this.load()}return n(t,null,[{key:"getInstance",value:function(){return this.instance||(this.instance=new this,w.installProvider(this.instance)),this.instance}}]),n(t,[{key:"load",value:function(){var n=this;return this.request().then(function(t){n.raw=t,n.normalizeData=n.normalize(t)})}},{key:"normalize",value:function(t){return u({},t,{last_environmental_impact_row:t.environmental_impact[t.environmental_impact.length-1],environmental_impact:t.environmental_impact.reduce(function(t,n){var e=n.Time.match(/(\d{2}) (\d{2}):\d{2}:\d{2}/);return t[[parseInt(e[1],10),parseInt(e[2],10)]]=n,t},{})})}},{key:"request",value:function(){var e=this;return new Promise(function(t){var n=new XMLHttpRequest;n.open("GET",e.constructor.API_ENDPOINT),n.send(),n.onload=function(){t(JSON.parse(n.response))}})}}]),t}();o(D,"API_ENDPOINT","https://cdn.gogoro.com/data/environmental-impact-v3.json"),o(D,"instance",void 0);var I=function(){function r(t,n){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(i(this,r),this.el=t,this.subjectInstance=this.constructor.subjects[n],!this.subjectInstance)throw"subject ".concat(n," is undefined");this.options=u({},r.default,{},e),m.typeCheckConfig(this.options,r.defaultType),this.subjectInstance.subscribe(this.update.bind(this))}return n(r,null,[{key:"boostrap",value:function(){var n=this,t=D.getInstance();if(!this.init){this.init=!0;var e=function(){for(var t in n.subjects){n.subjects[t].next()}};t.promise.then(function(){e(),setInterval(e,1e3),setInterval(t.load.bind(t),y)})}return t.promise}},{key:"getStaticValues",value:function(){var r=this;return D.getInstance().promise.then(function(){var t={};for(var n in r.subjects){var e=r.subjects[n];e.next(),t[n]=e.data}return t})}}]),n(r,[{key:"update",value:function(t){t="function"===m.toType(this.options.transform)?this.options.transform(t):new Function("$val","return ".concat(this.options.transform))(t),this.el.innerHTML=this.options.formatter(t)}}]),r}();return o(I,"init",!1),o(I,"default",{transform:"$val",formatter:function(t){return String(t).replace(/\B(?=(\d{3})+(?!\d))/g,",")}}),o(I,"defaultType",{transform:"string|function",formatter:"function"}),o(I,"subjects",new Proxy({stationsCount:new t,comingStationsCount:new g,onlineStationsCount:new O,CO2:new _,KM:new j,swapCount:new k,swapCountAvg30Days:new P,rackCount:new x},{get:function(t,n,e){return I.boostrap(),Reflect.get(t,n,e)}})),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("[data-number]").forEach(function(t){var n=m.getDataAttributes(t),e=n.number,r=f(n,["number"]);new I(t,e,r)})}),I});